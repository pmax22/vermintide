<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vermintide 2 - Chaos Wastes Weekly Tracker</title>
    <link rel="stylesheet" href="shared-styles.css">
    <style>
        .container { padding-top: 80px; }
        .page-header { text-align: center; margin-bottom: var(--space-2xl); }
        .page-header::before { content: 'üåÄ'; display: block; font-size: 2.5rem; margin-bottom: var(--space-md); animation: spin 10s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .page-header h1 { background: linear-gradient(180deg, #9370db 0%, #7b68ee 50%, #6a5acd 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .page-header .subtitle { font-family: 'IM Fell English', serif; font-size: 1.1rem; color: var(--text-muted); font-style: italic; }
        .current-week { background: linear-gradient(145deg, var(--bg-card) 0%, var(--bg-secondary) 100%); border: 2px solid #9370db; padding: var(--space-xl); margin-bottom: var(--space-2xl); position: relative; overflow: hidden; }
        .current-week::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, transparent, #9370db, #7b68ee, #9370db, transparent); }
        .current-week::after { content: 'CETTE SEMAINE'; position: absolute; top: 15px; right: 20px; font-family: 'Cinzel', serif; font-size: 0.7rem; color: #9370db; text-transform: uppercase; letter-spacing: 0.15em; padding: 4px 10px; border: 1px solid #9370db; background: rgba(147, 112, 219, 0.1); }
        .current-week-header { display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-lg); }
        .current-week-header h2 { font-family: 'Cinzel', serif; font-size: 1.5rem; color: #9370db; }
        .current-week-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: var(--space-xl); }
        .current-weapon-info { display: flex; flex-direction: column; gap: var(--space-sm); }
        .weapon-name { font-family: 'Cinzel', serif; font-size: 1.4rem; color: var(--text-light); }
        .weapon-illusion { font-family: 'IM Fell English', serif; font-style: italic; color: var(--text-muted); }
        .date-info { display: flex; align-items: center; gap: var(--space-sm); color: var(--text-secondary); font-size: 1rem; }
        .search-section { background: linear-gradient(145deg, var(--bg-card) 0%, var(--bg-secondary) 100%); border: 1px solid var(--border-subtle); padding: var(--space-xl); margin-bottom: var(--space-xl); }
        .search-section h2 { font-family: 'Cinzel', serif; font-size: 1.2rem; color: var(--gold-primary); margin-bottom: var(--space-lg); display: flex; align-items: center; gap: var(--space-md); }
        .search-section h2::before { content: 'üîç'; }
        .filter-label { font-family: 'Cinzel', serif; font-size: 0.85rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: var(--space-md); display: block; }
        .hero-filters { display: flex; flex-wrap: wrap; gap: var(--space-sm); margin-bottom: var(--space-lg); }
        .hero-filter-btn { font-family: 'Cinzel', serif; font-size: 0.85rem; padding: 10px 18px; background: rgba(0, 0, 0, 0.3); border: 2px solid var(--border-subtle); color: var(--text-secondary); cursor: pointer; text-transform: uppercase; letter-spacing: 0.05em; transition: all var(--transition-normal); }
        .hero-filter-btn:hover { border-color: var(--gold-muted); background: rgba(201, 169, 97, 0.1); }
        .hero-filter-btn.active { background: linear-gradient(180deg, var(--gold-muted) 0%, var(--gold-dark) 100%); border-color: var(--gold-primary); color: var(--bg-dark); }
        .search-box { position: relative; }
        .search-input { padding-left: 45px !important; }
        .search-icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--text-muted); pointer-events: none; }
        .results-section { background: linear-gradient(145deg, var(--bg-card) 0%, var(--bg-secondary) 100%); border: 1px solid var(--border-subtle); padding: var(--space-xl); }
        .results-section h2 { font-family: 'Cinzel', serif; font-size: 1.1rem; color: var(--gold-primary); margin-bottom: var(--space-lg); }
        .results-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: var(--space-md); }
        .weapon-card { background: rgba(0, 0, 0, 0.3); border: 1px solid var(--border-subtle); padding: var(--space-lg); transition: all var(--transition-normal); }
        .weapon-card:hover { border-color: var(--gold-muted); transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); }
        .weapon-card.current-week-card { 
            border: 2px solid #9370db; 
            background: linear-gradient(145deg, rgba(147, 112, 219, 0.2) 0%, rgba(0, 0, 0, 0.3) 100%);
            box-shadow: 0 0 20px rgba(147, 112, 219, 0.3);
        }
        .weapon-card-content { display: flex; justify-content: space-between; align-items: flex-start; gap: var(--space-md); }
        .weapon-info { flex: 1; }
        .weapon-type { font-family: 'Cinzel', serif; font-size: 1.1rem; color: var(--text-light); margin: var(--space-sm) 0; }
        .week-info { text-align: right; }
        .week-number { font-family: 'Cinzel', serif; font-size: 0.9rem; color: var(--gold-primary); margin-bottom: var(--space-xs); }
        .week-dates { font-size: 0.85rem; color: var(--text-muted); }
        @media (max-width: 768px) { .container { padding-top: 20px; } .current-week::after { position: static; display: inline-block; margin-bottom: var(--space-md); } .current-week-content { grid-template-columns: 1fr; } .results-list { grid-template-columns: 1fr; } .weapon-card-content { flex-direction: column; } .week-info { text-align: left; margin-top: var(--space-md); padding-top: var(--space-md); border-top: 1px solid var(--border-subtle); width: 100%; } }
    </style>
</head>
<body>
    <a href="index.html" class="back-button">Retour</a>
    <div class="container">
        <header class="page-header">
            <h1>Chaos Wastes Weekly</h1>
            <p class="subtitle">Rotation des skins Bitter Dreams</p>
        </header>
        <div class="current-week">
            <div class="current-week-header"><h2>Arme de la Semaine</h2></div>
            <div class="current-week-content">
                <div class="current-weapon-info">
                    <span id="current-hero-badge" class="hero-badge">Loading...</span>
                    <div class="weapon-name" id="current-weapon-type">Chargement...</div>
                    <div class="weapon-illusion" id="current-weapon-name">...</div>
                </div>
                <div class="date-info"><span>üìÖ</span><span id="current-week-dates">...</span></div>
            </div>
        </div>
        <div class="search-section">
            <h2>Rechercher une arme</h2>
            <span class="filter-label">Filtrer par h√©ros</span>
            <div class="hero-filters" id="hero-filters">
                <button class="hero-filter-btn active" data-hero="all">Tous</button>
                <button class="hero-filter-btn" data-hero="Kerillian">Kerillian</button>
                <button class="hero-filter-btn" data-hero="Kruber">Kruber</button>
                <button class="hero-filter-btn" data-hero="Bardin">Bardin</button>
                <button class="hero-filter-btn" data-hero="Sienna">Sienna</button>
                <button class="hero-filter-btn" data-hero="Viktor">Viktor</button>
            </div>
            <div class="search-box">
                <span class="search-icon">üîé</span>
                <input type="text" id="search-input" class="search-input" placeholder="Rechercher par type d'arme...">
            </div>
        </div>
        <div class="results-section">
            <h2 id="results-count">R√©sultats (54)</h2>
            <div class="results-list" id="results-list"></div>
        </div>
    </div>
    <script>
        const WEAPONS_DATA = [
            { index: 1, hero: "Kerillian", weaponType: "Dual Dagger", name: "Daggers of Bitter Dreams" },
            { index: 2, hero: "Kruber", weaponType: "Longbow", name: "Longbow of Bitter Dreams" },
            { index: 3, hero: "Bardin", weaponType: "Handgun", name: "Handgun of Bitter Dreams" },
            { index: 4, hero: "Sienna", weaponType: "Conflagration Staff", name: "Conflagration Staff of Bitter Dreams" },
            { index: 5, hero: "Viktor", weaponType: "Greatsword", name: "Greatsword of Bitter Dreams" },
            { index: 6, hero: "Kerillian", weaponType: "Hagbane Shortbow", name: "Hagbane Bow of Bitter Dreams" },
            { index: 7, hero: "Kruber", weaponType: "Executioner Sword", name: "Executioner Sword of Bitter Dreams" },
            { index: 8, hero: "Bardin", weaponType: "1H Hammer", name: "Hammer of Bitter Dreams" },
            { index: 9, hero: "Sienna", weaponType: "Bolt Staff", name: "Bolt Staff of Bitter Dreams" },
            { index: 10, hero: "Viktor", weaponType: "Volley Crossbow", name: "Volley Crossbow of Bitter Dreams" },
            { index: 11, hero: "Kerillian", weaponType: "Elven Spear", name: "Spear of Bitter Dreams" },
            { index: 12, hero: "Kruber", weaponType: "Blunderbuss", name: "Blunderbuss of Bitter Dreams" },
            { index: 13, hero: "Bardin", weaponType: "Axe + Shield", name: "Axe and Shield of Bitter Dreams" },
            { index: 14, hero: "Sienna", weaponType: "1H Mace", name: "Mace of Bitter Dreams" },
            { index: 15, hero: "Viktor", weaponType: "Brace of Pistols", name: "Pistols of Bitter Dreams" },
            { index: 16, hero: "Kerillian", weaponType: "Volley Crossbow", name: "Volley Crossbow of Bitter Dreams" },
            { index: 17, hero: "Kruber", weaponType: "Repeating Handgun", name: "Repeating Handgun of Bitter Dreams" },
            { index: 18, hero: "Bardin", weaponType: "War Pick", name: "War Pick of Bitter Dreams" },
            { index: 19, hero: "Sienna", weaponType: "Flame Sword", name: "Flame Sword of Bitter Dreams" },
            { index: 20, hero: "Viktor", weaponType: "1H Axe", name: "Axe of Bitter Dreams" },
            { index: 21, hero: "Kerillian", weaponType: "Longbow", name: "Longbow of Bitter Dreams" },
            { index: 22, hero: "Kruber", weaponType: "Mace and Shield", name: "Mace and Shield of Bitter Dreams" },
            { index: 23, hero: "Bardin", weaponType: "Drakefire Pistols", name: "Drakefire Pistols of Bitter Dreams" },
            { index: 24, hero: "Sienna", weaponType: "Flamestorm Staff", name: "Flamestorm Staff of Bitter Dreams" },
            { index: 25, hero: "Viktor", weaponType: "Fencing Sword", name: "Rapier of Bitter Dreams" },
            { index: 26, hero: "Kerillian", weaponType: "1H Sword", name: "Sword of Bitter Dreams" },
            { index: 27, hero: "Kruber", weaponType: "1H Mace", name: "Mace of Bitter Dreams" },
            { index: 28, hero: "Bardin", weaponType: "1H Axe", name: "Axe of Bitter Dreams" },
            { index: 29, hero: "Sienna", weaponType: "Dagger", name: "Dagger of Bitter Dreams" },
            { index: 30, hero: "Viktor", weaponType: "Falchion", name: "Falchion of Bitter Dreams" },
            { index: 31, hero: "Kerillian", weaponType: "Glaive", name: "Glaive of Bitter Dreams" },
            { index: 32, hero: "Kruber", weaponType: "1H Sword", name: "Sword of Bitter Dreams" },
            { index: 33, hero: "Bardin", weaponType: "Great Axe", name: "Great Axe of Bitter Dreams" },
            { index: 34, hero: "Sienna", weaponType: "Beam Staff", name: "Beam Staff of Bitter Dreams" },
            { index: 35, hero: "Viktor", weaponType: "Crossbow", name: "Crossbow of Bitter Dreams" },
            { index: 36, hero: "Kerillian", weaponType: "Greatsword", name: "Greatsword of Bitter Dreams" },
            { index: 37, hero: "Kruber", weaponType: "Great Hammer", name: "Great Hammer of Bitter Dreams" },
            { index: 38, hero: "Bardin", weaponType: "Great Hammer", name: "Great Hammer of Bitter Dreams" },
            { index: 39, hero: "Sienna", weaponType: "Fireball Staff", name: "Fireball Staff of Bitter Dreams" },
            { index: 40, hero: "Bardin", weaponType: "Drakegun", name: "Drakegun of Bitter Dreams" },
            { index: 41, hero: "Kerillian", weaponType: "Sword & Dagger", name: "Sword and Dagger of Bitter Dreams" },
            { index: 42, hero: "Kruber", weaponType: "Greatsword", name: "Greatsword of Bitter Dreams" },
            { index: 43, hero: "Bardin", weaponType: "Crossbow", name: "Crossbow of Bitter Dreams" },
            { index: 44, hero: "Viktor", weaponType: "Repeating Pistol", name: "Repeating Pistol of Bitter Dreams" },
            { index: 45, hero: "Bardin", weaponType: "Dual Axes", name: "Dual Axes of Bitter Dreams" },
            { index: 46, hero: "Kerillian", weaponType: "Dual Swords", name: "Dual Swords of Bitter Dreams" },
            { index: 47, hero: "Kruber", weaponType: "Halberd", name: "Halberd of Bitter Dreams" },
            { index: 48, hero: "Bardin", weaponType: "Grudge Raker", name: "Grudge Raker of Bitter Dreams" },
            { index: 49, hero: "Sienna", weaponType: "1H Sword", name: "Sword of Bitter Dreams" },
            { index: 50, hero: "Viktor", weaponType: "Flail", name: "Flail of Bitter Dreams" },
            { index: 51, hero: "Kerillian", weaponType: "Shortbow", name: "Shortbow of Bitter Dreams" },
            { index: 52, hero: "Kruber", weaponType: "Handgun", name: "Handgun of Bitter Dreams" },
            { index: 53, hero: "Bardin", weaponType: "Hammer & Shield", name: "Hammer and Shield of Bitter Dreams" },
            { index: 54, hero: "Kruber", weaponType: "Sword & Shield", name: "Sword and Shield of Bitter Dreams" }
        ];
        
        // Date de r√©f√©rence: mardi 13 janvier 2026 = Index 5
        // Les semaines vont du mardi au lundi
        const REFERENCE_DATE = new Date(2026, 0, 13); // Mardi 13 janvier 2026
        const REFERENCE_INDEX = 5;
        
        let selectedHero = 'all';
        let searchTerm = '';
        
        function getCurrentWeekData() {
            const today = new Date();
            const daysSinceRef = Math.floor((today - REFERENCE_DATE) / (1000 * 60 * 60 * 24));
            const weeksSinceRef = Math.floor(daysSinceRef / 7);
            let currentIndex = ((REFERENCE_INDEX - 1 + weeksSinceRef) % 54) + 1;
            if (currentIndex < 1) currentIndex += 54;
            
            const currentWeapon = WEAPONS_DATA.find(w => w.index === currentIndex);
            
            // Calculer le d√©but de semaine (mardi)
            const weekStart = new Date(REFERENCE_DATE);
            weekStart.setDate(weekStart.getDate() + (weeksSinceRef * 7));
            const weekEnd = new Date(weekStart);
            weekEnd.setDate(weekEnd.getDate() + 6); // Jusqu'au lundi suivant
            
            // Calculer le num√©ro de semaine
            const weekNumber = Math.floor((weekStart - new Date(weekStart.getFullYear(), 0, 1)) / (1000 * 60 * 60 * 24 * 7)) + 1;
            
            return { weapon: currentWeapon, weekStart, weekEnd, weekNumber, currentIndex };
        }
        
        function getWeekForWeapon(weaponIndex) {
            let weeksDiff = weaponIndex - REFERENCE_INDEX;
            if (weeksDiff < 0) weeksDiff += 54;
            
            // Calculer le d√©but de semaine (mardi)
            const weekStart = new Date(REFERENCE_DATE);
            weekStart.setDate(weekStart.getDate() + (weeksDiff * 7));
            const weekEnd = new Date(weekStart);
            weekEnd.setDate(weekEnd.getDate() + 6); // Jusqu'au lundi suivant
            
            // Calculer le num√©ro de semaine
            const weekNumber = Math.floor((weekStart - new Date(weekStart.getFullYear(), 0, 1)) / (1000 * 60 * 60 * 24 * 7)) + 1;
            
            return { weekStart, weekEnd, weekNumber };
        }
        
        function formatDate(date, includeYearIfDifferent = true) { 
            const currentYear = new Date().getFullYear();
            const dateYear = date.getFullYear();
            
            if (includeYearIfDifferent && dateYear !== currentYear) {
                return date.toLocaleDateString('fr-FR', { day: 'numeric', month: 'long', year: 'numeric' });
            }
            return date.toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' }); 
        }
        
        function formatDateWithYear(date) {
            return date.toLocaleDateString('fr-FR', { day: 'numeric', month: 'long', year: 'numeric' });
        }
        
        function displayCurrentWeek() {
            const currentWeek = getCurrentWeekData();
            document.getElementById('current-hero-badge').textContent = currentWeek.weapon.hero;
            document.getElementById('current-hero-badge').className = `hero-badge hero-${currentWeek.weapon.hero}`;
            document.getElementById('current-weapon-type').textContent = currentWeek.weapon.weaponType;
            document.getElementById('current-weapon-name').textContent = currentWeek.weapon.name;
            
            // Afficher le num√©ro de semaine et les dates
            const currentYear = new Date().getFullYear();
            const yearSuffix = currentWeek.weekEnd.getFullYear() !== currentYear ? ` ${currentWeek.weekEnd.getFullYear()}` : '';
            document.getElementById('current-week-dates').textContent = 
                `Semaine ${currentWeek.weekNumber} - Du ${formatDate(currentWeek.weekStart, false)} au ${formatDate(currentWeek.weekEnd, false)}${yearSuffix}`;
        }
        
        function filterWeapons() {
            return WEAPONS_DATA.filter(weapon => {
                const matchesHero = selectedHero === 'all' || weapon.hero === selectedHero;
                const matchesSearch = weapon.weaponType.toLowerCase().includes(searchTerm.toLowerCase()) || 
                                     weapon.name.toLowerCase().includes(searchTerm.toLowerCase());
                return matchesHero && matchesSearch;
            });
        }
        
        function displayResults() {
            const filtered = filterWeapons();
            const currentWeek = getCurrentWeekData();
            const currentYear = new Date().getFullYear();
            const resultsList = document.getElementById('results-list');
            document.getElementById('results-count').textContent = `R√©sultats (${filtered.length})`;
            
            // Trier par date (ordre chronologique √† partir du d√©but de l'ann√©e)
            const sortedWeapons = filtered.map(weapon => {
                const weekInfo = getWeekForWeapon(weapon.index);
                return { ...weapon, weekInfo };
            }).sort((a, b) => a.weekInfo.weekStart - b.weekInfo.weekStart);
            
            resultsList.innerHTML = sortedWeapons.map(weapon => {
                const isCurrentWeek = weapon.index === currentWeek.currentIndex;
                const cardClass = isCurrentWeek ? 'weapon-card current-week-card' : 'weapon-card';
                
                // Afficher l'ann√©e si elle est diff√©rente de l'ann√©e en cours
                const startDateFormatted = formatDate(weapon.weekInfo.weekStart, true);
                const endDateFormatted = formatDate(weapon.weekInfo.weekEnd, true);
                
                return `<div class="${cardClass}">
                    <div class="weapon-card-content">
                        <div class="weapon-info">
                            <div class="hero-badge hero-${weapon.hero}">${weapon.hero}</div>
                            <div class="weapon-type">${weapon.weaponType}</div>
                            <div class="weapon-illusion">${weapon.name}</div>
                        </div>
                        <div class="week-info">
                            <div class="week-number">Semaine ${weapon.weekInfo.weekNumber}</div>
                            <div class="week-dates">${startDateFormatted} - ${endDateFormatted}</div>
                        </div>
                    </div>
                </div>`;
            }).join('');
        }
        
        document.getElementById('hero-filters').addEventListener('click', (e) => {
            if (e.target.classList.contains('hero-filter-btn')) {
                document.querySelectorAll('.hero-filter-btn').forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');
                selectedHero = e.target.dataset.hero;
                displayResults();
            }
        });
        
        document.getElementById('search-input').addEventListener('input', (e) => { 
            searchTerm = e.target.value; 
            displayResults(); 
        });
        
        displayCurrentWeek();
        displayResults();
    </script>
</body>
</html>
